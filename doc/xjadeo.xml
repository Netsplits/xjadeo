<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" 
	[
	 <!ENTITY avinfodtd SYSTEM "../src/xjadeo/avinfo.dtd">
	]
>

<article>
  <articleinfo>
    <title><application>xjadeo</application> - X Jack Video Monitor</title>
    <subtitle><ulink url="http://xjadeo.sourceforge.net"></ulink></subtitle>
     <copyright>
	<year>2005</year>
	<year>2006</year>
	<holder>Robin Gareus, Luis Garrido</holder>
     </copyright>
							 
     <abstract>

    <para><application>xjadeo</application> is a program that displays a video
    clip in sync with an external time source, which comes quite handy when you want to create a
    soundtrack for a movie.</para>
    
    <para>It has applications in soundtrack creation, video monitoring or 
    any task that requires to associate movie frames with audio events.</para>

    <para><application>xjadeo</application> supports different video file
    formats, display libraries and sync sources. It includes an optional
    GUI <application>qjadeo</application> that provides file-history and
    allows to modify settings of a running <application>xjadeo</application>
    instance.</para>

    <para><application>xjadeo</application> is being developed on the
    GNU/Linux operating system, but not limited to it. </para>
  
     </abstract>

  </articleinfo>

  <section id="introduction">
    <title>Introduction and Copyrights</title>

  <section id="news">
    <title>NEWS</title>

    <para><application>xjadeo v0.4-rc1</application> is a oven-fresh rewrite. Some
    of the documentation is still so hot that is not readably rendered.
    If you're already interested, see the NEWS and Changelog files
    provided with the source. This manual (as well as xjadeo itself) is work in progress..</para>

    <para>As you might have noticed by the logo, we will need an upgrade from Super-16 to 35mm! XPMs are welcome.</para>
  </section>

  <section id="download">
    <title>DOWNLOAD</title>
    <para> <application>xjadeo</application> is available at 
    <ulink url="http://sourceforge.net/project/showfiles.php?group_id=131926">Sourceforge</ulink>. 
    Read <xref linkend="build_instructions"/> for further information.
    </para>
  </section>

  <section id="license">
    <title>LICENSE</title>

    <para><application>xjadeo</application> is free software; you can
    redistribute it and/or modify it under the terms of the GNU General Public
    License as published by the Free Software Foundation; either version 2 of
    the License, or (at your option) any later version.</para>

    <para>This program is distributed in the hope that it will be useful, but
    WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
    for more details.</para>

    <para>You should receive a copy of the GNU General Public License along
    with the program; if not, write to the Free Software Foundation, Inc., 59
    Temple Place, Suite 330, Boston, MA 02111-1307 USA</para>
  </section>

  <section id="features">
    <title>FEATURES</title>
    <para><application>xjadeo</application> - video Monitor </para>

    <itemizedlist>
      <listitem>
        <para>Display modes: <itemizedlist>
            <listitem>
              <para>XV (hardware accelerated)</para>
            </listitem>

            <listitem>
              <para>SDL (hardware accelerated) - probably deprecated soon.</para>
            </listitem>

            <listitem>
              <para>imlib2/X11</para>
            </listitem>

            <listitem>
              <para>imlib/X11</para>
            </listitem>
          </itemizedlist></para>
      </listitem>

      <listitem>
        <para>Video stream decoding via FFMPEG,
        <application>xjadeo</application> supports MPEG/VOB, AVI, ASF/WMA/WMV,
        RM, QT/MOV/MP4, Ogg/OGM, MKV, VIVO, FLI, yuv4mpeg films, provided they
        use a seekable encoding.</para>
      </listitem>

      <listitem>
        <para>Sync source:<itemizedlist>
            <listitem>
              <para> <ulink url="http://jackaudio.org/">jack</ulink> transport.</para>
            </listitem>

            <listitem>
              <para>MTC using either ALSA midi or portmidi.</para>
            </listitem>
          </itemizedlist></para>
      </listitem>

      <listitem>
        <para>Remote control interface allows to query and modify all of
        <application>xjadeo</application>'s settings and parameters via standard I/O.</para>
      </listitem>

      <listitem>
        <para>LASH - session management.</para>
      </listitem>

      <listitem>
        <para>Optional Qt Graphical User interface via remote control
        interface.</para>
      </listitem>
    </itemizedlist>
  </section>

  <section id="credits">
    <title>CREDITS AND ACKNOWLEDGMENTS</title>

    <para><application>xjadeo</application> was designed and written by Luis
    Garrido and Robin Gareus.</para>

    <para>Fortunately we stand on the GNU giants' shoulders (both of em). See header and comments in
    the source files for more detailed information.</para>

    <itemizedlist>
      <listitem>
        <para>XV, SDL and imlib display code was inspired by playdv of <ulink
        url="http://libdv.sourceforge.net/">http://libdv.sourceforge.net/</ulink>
        written by Charles 'Buck' Krasic and Erik Walthinsen.</para>
      </listitem>

      <listitem>
        <para>Original ffmpeg code (xjadeo-0.1)<ulink
        url="http://www.inb.uni-luebeck.de/~boehme/using_libavcodec.html">http://www.inb.uni-luebeck.de/~boehme/using_libavcodec.html</ulink></para>
      </listitem>

      <listitem>
        <para>XLib code:<ulink
        url="http://www.ac3.edu.au/SGI_Developer/books/XLib_PG/sgi_html/index.html">http://www.ac3.edu.au/SGI_Developer/books/XLib_PG/sgi_html/index.html</ulink></para>
      </listitem>
      <listitem>
	<para>X11-fullscreen code credits: <ulink url="http://www.mplayerhq.hu">mplayer</ulink>.</para>
      </listitem>

      <listitem>
        <para>portmidi has nice example code, without any credits. same goes
        for freetype2. many kudos!</para>
      </listitem>

      <listitem>
        <para>the xjadeo alsamidi sequencer was inspired by the alsa-tools
        amidi.c and aseqdump.c written by Clemens Ladisch</para>
      </listitem>

      <listitem>
        <para>jack: <ulink
        url="http://jackaudio.org/files/docs/html/transport-design.html">http://jackaudio.org/files/docs/html/transport-design.html</ulink></para>
      </listitem>
    </itemizedlist>
  </section>

  <section id="prospects">
    <title>PROSPECTS</title>
	
    <para>Future releases of xjadeo will be more comprehensive. xjadeo will settle for X11/Xv, support VSync and buffered video. see the TODO file in the source or contact the developers if you are interested.</para>

    <para>It's a thighrope walk between audio-helper-application (low profile) and pro-A/V-tool (exact video sync).</para>

    <para>xjadeo started as a collection of example code end is being used as that. People use it as code repository to spin-off c based video installations..   Parts of <application>xjadeo</application> have been re-used for various VJ purposes, mainly to synchronize playback on multiple screens (using <ulink url="netjack.sourceforge.net">netjack</ulink> and/or xjadeo remote-ctrl see <xref linkend="sync_remote_commands" /> ). check <ulink url="http://svn.sourceforge.net/viewcvs.cgi/xjadeo/trunk/contrib/">http://svn.sourceforge.net/viewcvs.cgi/xjadeo/trunk/contrib/</ulink> for further additions.</para>

    <para>With minor modifications xjadeo can read video-frame-offset lists (EDL) and do the editing during playback. It is unlikely for this to be merged in the main distribution. video editing, although sometimes handy, is clearly beyond xjadeo's scope.  check out: <ulink url="http://openmovieeditor.sourceforge.net/">Open Movie Editor</ulink> or use the EDL capabilities of mplayer/mencoder, or go <ulink url="http://cinelerra.org/">cinelarra<ulink>. join the discussion <ulink url="http://openmtes.tomveens.nl/">Openmtes</ulink> </para>
  </section>

  </section>

  <section id="build_instructions" xreflabel="Build and Install Instructions">
    <title>Build and Install Instructions</title>

    <section id="system_requirements">
      <title>System Requirements</title>
      <para><application>xjadeo</application> is currently known to work on
      gnu/Linux and Mac OS-X. It is compatible with any modern Linux distribution.
      There are no special hardware requirements.</para>
    </section>

    <section id="section_binaries_and_sources">
      <title id="binaries_and_sources" >Binaries and Sources</title>

      <para><application>xjadeo</application> is developed using Subversion
      repositories at <ulink
      url="http://svn.sourceforge.net/xjadeo/">http://svn.sourceforge.net/xjadeo/</ulink>.
      In case you are unfamiliar with SVN, Sourceforge <ulink
      url="http://sourceforge.net/svn/?group_id=131926">provides</ulink>
      information on how to access it.</para>

      <para><application>xjadeo</application> is also available for <ulink
      url="http://sourceforge.net/project/showfiles.php?group_id=131926">download</ulink>
      as source and binary package.</para>

      <para>A Debian package can be found at <ulink
      url="http://www.debian-multimedia.org/">debian-multimedia</ulink>
      edit <filename>/etc/apt/sources.list</filename> to include
      <screen>
deb http://www.debian-multimedia.org sid main
deb-src http://www.debian-multimedia.org sid main</screen>
      (replace <option>sid</option>  by your distribution name)
      and run <command>apt-get update</command> followed by <command>apt-get install xjadeo</command> (or use your favorite software package tool).</para>
      <para>Note that xjadeo >v0.3 also works with <ulink url="http://packages.debian.org/unstable/libdevel/libavformat-dev">official debian ffmpeg</ulink> packages, you can <command>dpkg-buildpackage</command> the latest SVN.</para>

      <para>&#187;Packman&#171; kindly provides SVN-snapshot <ulink url="http://packman.links2linux.de/package/xjadeo">xjadeo RPM</ulink> packages for SuSE Linux.</para>
    </section>

    <section id="build_depends" xreflabel="build dependencies">
      <title>Build Dependencies</title>

      <para>In order to compile the xjadeo from source, you will need the
      "devel" (-dev) version of these libraries.</para>

      <para>Mandatory Libraries:
        <itemizedlist>
          <listitem>
            <para><ulink url="http://jackaudio.org/">jack-audio-connection-kit</ulink></para>
          </listitem>
          <listitem>
            <para><ulink url="http://ffmpeg.mplayerhq.hu/">ffmpeg</ulink> (libavcodec, libavformat/libavutil)</para>
          </listitem>
	 </itemizedlist>
     </para>

     <para>Video Display Libraries. (you need at least one of the following)
        <itemizedlist>
          <listitem>
            <para><ulink url="http://xorg.freedesktop.org">libXV</ulink> (recommended)</para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.enlightenment.org/Libraries/Imlib/">IMlib &ge; 1.9.13</ulink></para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.enlightenment.org/Libraries/Imlib2/">IMlib2</ulink></para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.libsdl.org">SDL 1.2</ulink></para>
          </listitem>
	 </itemizedlist>
      </para>

      <para>Optional libraries:
        <itemizedlist>
          <listitem>
            <para><ulink url="http://freetype.org">Freetype 2</ulink> (actually libfreetype6_2) - for On Screen display.</para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.cs.cmu.edu/~music/portmusic/portmidi/">portmidi</ulink> - Midi Clock</para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.alsa-project.org/">ALSA</ulink> (alsa-lib, libasound) - alternate Midi Time Clock</para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.trolltech.com/products/qt/qt3">QT3</ulink> - qjadeo Graphical User Interface</para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.trolltech.com/products/qt/downloads">QT4</ulink> + qt3compat - new qjadeo GUI</para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.nongnu.org/lash/">lash</ulink> for restoring sessions.</para>
          </listitem>
          <listitem>
            <para>librt (from the <ulink url="http://www.gnu.org/software/libc/">GNU C Library</ulink> > 2.3.2(?)) - POSIX message queues (requires kernel support - Linux >= 2.6.6)</para>
          </listitem>
	 </itemizedlist>
      </para>

      <para>QT is only needed to compile and run the qjadeo GUI - not xjadeo itself.  qjadeo works with 
      both QT3 or QT4. If both libraries are available QT4 is preferred by the configure script.
      Override by setting the QTDIR environment variable.  You can certainly build and use xjadeo without the GUI. 
      </para>

<!-- <para>Note that you can not use the GUI with lash resumed xjadeo sessions unless you a message queue setup.</para> !-->

      <para>Other dependencies:</para>

      <para>Furthermore you'll need <application>autotools</application> (automake >= 1.7, autoconf) to generate the build
      environment, and the standard gnu devel system (<application>gcc</application>, <application>make</application>, glibc-devel, etc) to compile it.
      </para>
      
      <para>We also recommend to install <application>mencoder</application>
      to convert the video file to a suitable format.</para>

      <para>Pay special attention to ffmpeg, since some
      versions of this package are not compatible with xjadeo.</para>

    </section>

    <section id="build" xreflabel="building xjadeo">
      <title>Building xjadeo</title>

      <para>If you are using sources from the <ulink url="http://sourceforge.net/svn/?group_id=131926">subversion repository</ulink>, you'll first need to generate the configuration script in the <filename>xjadeo/trunk/</filename>:
      <screen>
cd xjadeo/trunk/
./autogen.sh</screen></para>

      <para>Once you have all the build dependencies and uncompressed the xjadeo tar.gz the usual spells apply:
      <screen>
./configure
make 
make install # (requires root privileges) </screen></para>

      <para>The configuration process tries to autodetect and include
      supported features. However you might want to consider using some of the
      compilation options. run <command>./configure --help</command> for a
      full list of available arguments.<variablelist>
          <varlistentry>
            <term><option>--enable-midi=auto</option></term>

            <listitem>
              <para>Choose midi library to use. good values are <option>auto</option>
	      <option>portmidi</option>, <option>alsamidi</option>, <option>none</option>.
              The current default is to to use alsa-midi
              if available and fall back to using portmidi.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>--with-fontfile=/path/to/font.ttf</option></term>

            <listitem>
              <para>Set the default (hardcoded) true type font file to use for OSD.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>--enable-sdl</option></term>

            <listitem>
              <para>include the SDL video mode.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>--disable-ft</option></term>

            <listitem>
              <para>Disables the use of freetype2 for On Screen Display.
              xjadeo will be build without on screen display support</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>--disable-qtgui</option></term>

            <listitem>
              <para>Do not build the QT Graphical User Interface.</para>
            </listitem>
          </varlistentry>
        </variablelist></para>

    </section>
  </section>

  <section id="usage" xreflabel="xjadeo usage section">
    <title>Using xjadeo</title>

    <para>It's not that complicated: for the impatient: run <command>xjadeo video-file.avi</command> from an xterm to get a default monitor window displaying the specified video file synchronously to jack transport. You can use <command>qjackctl</command> or any jack transport aware application to start, stop or reposition the transport location. </para>
    <para> <command>xjadeo --help</command> will give you a list of available command line options.  please refer to the manual in the appendix.</para>

    <para>If you prefer, you can also use the graphical user interface <command>qjadeo</command>, be aware that qjadeo only provides a limited set of features.</para>

    <para>But let's back off a little, first you will need a suitable video file to display..</para>

    <section id="video_formats">
      <title>Video Formats</title>

      <para><application>xjadeo</application> has been designed to aid
      creative people and not as a general purpose video player. As it is most likely that you will work
      with the video file for a while, you should take some time to convert in to suitable format for your purpose, trading off I/O and the efforts to decode the file.</para>
      <para><application>xjadeo</application> uses <ulink
      url="http://ffmpeg.sourceforge.net/">ffmpeg</ulink> to decode the video
      file and supports only seekable video streams. Probably you
      first need to encode your video file to a <ulink
      url="http://ffmpeg.sourceforge.net/faq.html">supported
      format</ulink>.</para>

      <para>We recommend <application>mencoder</application> that comes with
      mplayer: <screen> mencoder -idx -ovc lavc -lavcopts keyint=1 -nosound input-file.xxx -o output-file.avi</screen>
      This creates from your <filename>input-file.xxx</filename> an
      AVI mpeg4 encoded video file with no sound, an index (-idx) and no
      compression between frames (every frame is a key frame). The file thus
      can become really BIG, so watch out your disk space. You may also want
      to shrink the size of the frame by adding the option</para>

      <screen>-vf scale=width:height</screen>

      <para>This will reduce the size of the avi file, will tax less the
      system resources when displayed and will leave more space in the screen
      for your audio software..</para>

      <para>In the <ulink
      url="http://svn.sourceforge.net/viewcvs.cgi/*checkout*/xjadeo/trunk/contrib/xjadeo-example.avi"><filename>contrib/</filename></ulink>
      folder there is an example video and a shell script that can help you
      finding an appropriate codec.</para>
    </section>

    <section id="invoking_xjadeo">
      <title>Invoking xjadeo</title>

      <para><command>xjadeo [options] output-file.avi</command></para>

      <para>There you are. If you use, for instance, muse 0.7, you can now
      fool around with its transport controls and see your video clip moving
      along. When the sequencer is playing at normal speed, the video will
      play at the framerate you set on the command line. Default is 10 fps,
      the lower the framerate, the smaller is the impact of xjadeo on the
      performance of your system.</para>

      <section id="sync_methods">
        <title>Sync Methods</title>

        <para>xjadeo polls the time code information in the following order,
        using the first available:</para>

        <orderedlist>
          <listitem>
            <para>Midi MTC (if connected).</para>
          </listitem>

          <listitem>
            <para>jack (if connected).</para>
          </listitem>

          <listitem>
            <para>default value (settable using <command>seek</command> remote
            command).</para>
          </listitem>
        </orderedlist>

        <para>per default <application>xjadeo</application> connects to jackd
        on startup. This behavior can be overridden by command line arguments
        or using the remote control interface.</para>

        <para>the offset value is added after converting the frames to the
        video file FPS format. followed by binding the displayed frame into
        the range of the video file duration.</para>
      </section>
    </section>

    <section id="interaction">
      <title>Interacting with xjadeo</title>
      <para>
      In most cases you will start up xjadeo with your favorite command line options and not come back to bother again.
      However you may find it useful to change some settings during runtime:</para>

      <section id="remote_control_interaction">
      	<title>Remote Control</title>
      	<para>If you do not want to re-focus your keyboard to the xjadeo window use <xref linkend="xjremote" /> and jump <xref linkend="remote_control_interface" />.</para>
      </section>

      <section id="x_window_interaction">
      	<title>Monitor Window - Key bindings</title>
      	<para>xjadeo accepts keyboard input and can receive Drag and Drop URIs.</para>
	<para> Key bindings are work in progress likely to change... that said,
    <variablelist>
        <varlistentry>
          <term><option>Esc</option></term>
          <listitem> <para>Terminates xjadeo.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>q</option></term>
          <listitem> <para>Identical to pressing the Escape key.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>a</option></term>
          <listitem> <para>Toggle window always-on-top.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>f</option></term>
          <listitem> <para>Toggle fullscreen mode.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>l</option></term>
          <listitem> <para>Toggle letterbox / scale breaking aspect-ratio.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>o</option></term>
          <listitem> <para>cycle offset OSD: video-frames / smpte / [off|osd-text].</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>s</option></term>
          <listitem> <para>Toggle OSD smpte.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>v</option></term>
          <listitem> <para>Toggle OSD frame.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>b</option></term>
          <listitem> <para>Draws a black box around the OSD items.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>C</option></term>
          <listitem> <para>Clear all on screen display information.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>e</option></term>
          <listitem> <para>Toggle display of Color-Equalizer. (only XV and imlib2)</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>E</option></term>
          <listitem> <para>Reset Color-Equalizer to default values.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>m</option></term>
          <listitem> <para>Toggle mouse pointer visibilty.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>&lt;</option></term>
          <listitem> <para>Decrease window size by a factor of 1.2 .</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>&gt;</option></term>
          <listitem> <para>Increase window size by a factor of 1.2 .</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>.</option></term>
          <listitem> <para>Resize window to original (moviefile) size.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>,</option></term>
          <listitem> <para>Scale window to match movies aspect ratio.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>+</option></term>
          <listitem> <para>Increment A/V offset by 1 videoframe.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>-</option></term>
          <listitem> <para>Decrement A/V offset by 1 videoframe.</para> </listitem>
        </varlistentry>
        <varlistentry>
          <term><option>0-9</option></term>
          <listitem> <para>change Color-EQ parameters with key pairs. 
	  brightness:1+2, contrast:3+4, gamma:5+6, saturation:7+8, hue:9+0</para>
	  <para>XV color balance is hardware dependant: Some boards to not support all parameters.
	  The imlib2 software EQ is limited to bri/cont/gamma.</para>
	  </listitem>
        </varlistentry>
    </variablelist>
	</para>
      </section>
    </section>

    <section id="Setups">
      <title>Setups</title>

      <section id="examples" xreflabel="example commandlines">
        <title>Example Commandlines</title>
        <para>
        <screen>xjadeo -f 25 -i 2 video-file.avi</screen> updates the monitor window 25 times per second and renders SMPTE on the bottom of the screen
        <screen>xjadeo -m -1 -v video-file.avi</screen> (using xjadeo compiled with portmidi) autoconnect to first available midi-in port and use arriving MTC messages display video in sync.
        <screen>xjadeo -f 12.5 -m 80:0 video-file.avi</screen> (using xjadeo compiled with ALSA seq) connect to midi device 80 port 0 and  display video in sync with MTC messages, updating the screen every 80ms.
        </para>
      </section>

      <section id="howto_lash">
        <title>LASH</title>
	<para> All you need is to have a <command>lashd</command> running. If you set the environement variable
	<command>LASH_START_SERVER</command> one will be
	<ulink url="http://www.nongnu.org/lash/lash-manual.html#SEC16">started</ulink> automatically. 
	Use <command>lash_panel</command> or fi. <ulink url="http://dino.nongnu.org/glashctl">glashctl</ulink> to manage your sessions.</para>
      </section>

      <section id="howto_ardour1">
        <title>Configure Ardour 0.99.X to sync to jack</title>

        <para><itemizedlist>
            <listitem>
              <para><menuchoice>
                  <guimenu>Windows</guimenu>

                  <guimenuitem>Option Editor</guimenuitem>
                </menuchoice></para>
            </listitem>

            <listitem>
              <para>Tab "Sync"</para>
            </listitem>

            <listitem>
              <para>Set "Positional Sync" to "Sync with JACK"</para>
            </listitem>

            <listitem>
              <para>Check option "JACK time master" (optional)</para>
            </listitem>

          </itemizedlist></para>
      </section>

      <section id="howto_ardour2">
        <title>Configure Ardour 2 to sync to jack</title>
	<para> You have not even started ardour2 before, have you? There's a nice looking button next to the SMPTE display.</para>
      </section>

      <section id="howto_rg">
        <title>configure rosegarden to run with xjadeo</title>

        <para><itemizedlist>
            <listitem>
              <para><menuchoice>
                  <guimenu>Settings</guimenu>

                  <guimenuitem>Configure Rosegarden</guimenuitem>
                </menuchoice></para>
            </listitem>

            <listitem>
              <para>Select "Sequencer" icon.</para>
            </listitem>

            <listitem>
              <para>Tab "Synchronization"</para>
            </listitem>

            <listitem>
              <para>Set "JACK transport mode" to "Sync"</para>
            </listitem>
          </itemizedlist></para>
      </section>
    </section>

    <section id="troubleshoot">
      <title>Troubleshoot</title>

      <para>In case xjadeo does not work out of the box..</para>

      <itemizedlist>
        <listitem>
          <para>can you play the (re-encoded) video with other players on your
          system ?</para>
        </listitem>

        <listitem>
          <para>run <command>xjadeo -v filename</command> - check displayed
          frame count and jack transport info.</para>
        </listitem>

        <listitem>
          <para>play the example from <ulink
          url="http://svn.sourceforge.net/viewcvs.cgi/*checkout*/xjadeo/trunk/contrib/xjadeo-example.avi">http://svn.sourceforge.net/viewcvs.cgi/*checkout*/xjadeo/trunk/contrib/xjadeo-example.avi</ulink></para>
        </listitem>

        <listitem>
          <para>ask for help and/or share your experience: <ulink
	  url="https://sourceforge.net/forum/?group_id=131926">https://sourceforge.net/forum/?group_id=131926</ulink>
	  </para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="problems" xreflabel="known issues">
      <title>Known Issues</title>

      <para>Some Video codecs are known not to work properly on some systems.
      This is mostly due to different ffmpeg versions, available codec
      decoders, etc.</para>

      <para><application>xjadeo</application> portmidi sync make xjadeo bail
      out if it fails to connect or encounters a MIDI buffer overflow. This is
      in fact a feature of portmidi but could also be considered a bug in
      <application>xjadeo</application>.</para>

      <para>X11 / nvidia might not work properly with the <ulink url="http://download.nvidia.com/XFree86/Linux-x86_64/1.0-8762/README/appendix-s.html">Composite Extension</ulink> as reported in the <ulink url="http://sourceforge.net/forum/forum.php?thread_id=1437336?forum_id=447923">Forum</ulink>.
	Temporarily disable this extension 
	<command>nvidia-xconfig --composite</command>
	<command>nvidia-xconfig --no-composite</command>
      or permanently disable it in your X configuration: 
      <screen>
      Section "Extensions" 
	      Option "Composite" "Disable" 
      EndSection 
      </screen>
      </para>

      <para>If you experience unexpected behavior please file a bug ticket at
      <ulink url="http://sourceforge.net/projects/xjadeo/">http://sourceforge.net/projects/xjadeo/</ulink>
      </para>
    </section>
  </section>

  <section id="remote_control_interface">
    <title>Remote Control Interface</title>

    <para>xjadeo features a remote control mode that allows to modify all
    settings of a running xjadeo monitor window. When started in remote mode
    (using option <option>-R</option> or <option>--remote</option>)
    <command>xjadeo</command> will interactively accept commands and issue
    responses through standard input/output mechanism.</para>

    <para>Since version 0.3.20 xjadeo implements POSIX <ulink url="http://www.linuxhowtos.org/manpages/7/mq_overview.htm">message queues</ulink> as an alternative to the stdio remote control. It provides the capability to dis- and re-connect to existing xjadeo sessions, which is particularly useful in combination with <ulink url="http://www.nongnu.org/lash/">LASH</ulink> sessions. For more information about message queues (MQ) read the <xref linkend="xjremote" /> manual.</para>

    <para>Note that <application>qjadeo</application> controls xjadeo via this interface</para>

    <para>Currently the jadeo remote control interpreter accepts the following commands:</para>

    <para>SUBJECT TO CHANGE. - use the <option>help</option> command for latest changes.</para>

    <section id="rc_general">
      <title>General Commands</title>

      <variablelist>
        <varlistentry>
          <term><option>help</option></term>

          <listitem>
            <para>print a list of available commands with a short
            description.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>quit</option></term>

          <listitem>
            <para>exit qjadeo.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <section id="rc_file">
      <title>Video File Commands</title>

      <variablelist>
        <varlistentry>
          <term><option>load <replaceable
          class="option">filename</replaceable></option></term>

          <listitem>
            <para>Load a video file, replacing any previous one.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>unload</option></term>

          <listitem>
            <para>Unload the current video file.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get filename</option></term>

          <listitem>
            <para>Returns the file name of the current movie.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get duration</option></term>

          <listitem>
            <para>Returns the length of the movie in seconds.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get frames</option></term>

          <listitem>
            <para>Returns the length of the movie in frames.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get framerate</option></term>

          <listitem>
            <para>Returns the frame rate of the current movie.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get width</option></term>

          <listitem>
            <para>Returns the width of the current movie in pixels.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get height</option></term>

          <listitem>
            <para>Returns the height of the current movie in pixels.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get seekmode</option></term>

          <listitem>
            <para>Returns an integer from 1 to 3 on how xjadeo seeks video frames.</para>
	      <variablelist>

		<varlistentry>
		  <term><option>1</option></term>
		  <listitem>
		  <para>seek <option>continuous</option>ly staring from the prev. keyframe.</para> 
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><option>2</option></term>
		  <listitem>
		  <para>seek directly to <option>any</option> frame.</para> 
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><option>3</option></term>
		  <listitem>
		  <para>seek only to <option>keyframe</option>s.</para> 
		  </listitem>
		</varlistentry>

	      </variablelist>

		
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>set seekmode <replaceable
          class="option">value</replaceable></option></term>

          <listitem>
            <para>Set the seekmode. valid parameters are integer 1-3 or any of the words: <option>keyframe</option>,  <option>any</option> or <option>continuous</option>. (the default is  <option>continuous</option> unless overridden with the <option>-k</option> command line option.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <section id="rc_sync">
      <title>Synchronization Commands</title>

      <section id="rc_jack">
        <title>Jack</title>

        <variablelist>
          <varlistentry>
            <term><option>jack connect</option></term>

            <listitem>
              <para>Get the synchronism from jack transport.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>jack disconnect</option></term>

            <listitem>
              <para>Stop synchronization with jack transport.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>jack status</option></term>

            <listitem>
              <para>Get the status of the connection with jack.</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>

      <section id="rc_midi">
        <title>Midi</title>

        <variablelist>
          <varlistentry>
            <term><option>midi reconnect </option></term>

            <listitem>
              <para>(Dis and re)connect to the last specifid midi port. The default port is -1, but it can be
	      overridden with <option>-m</option> or the <command>midi open &lt;port&gt;</command> command.</para>
	      <para>Note: when a MIDI port is connected, the jack transport information will be ignored, whether xjadeo is
	      connected to jack or not.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>midi connect <replaceable
            class="option">port</replaceable></option></term>

            <listitem>
              <para>Get sync from MTC (MIDI Time Code) instead of jack.</para>

              <para>If compiled with ALSA midi, <replaceable
              class="option">port</replaceable> is the ALSA sequencer id of
              the MTC source. A value of -1 will leave
              <command>xjadeo</command> unconnected.</para>

              <para>If using portmidi, <replaceable
              class="option">port</replaceable> is the port number of the midi
              input to use. WARNING: using an invalid id with portmidi will
              cause xjadeo to bail out!</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>midi disconnect </option></term>

            <listitem>
              <para>Close midi device.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>midi status </option></term>

            <listitem>
              <para>Displays the status of the xjadeo midi port
              connection.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>get midisync </option></term>

            <listitem>
              <para>Display midi SMPTE conversion mode, corresponding to -M
              option.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>set midisync <replaceable
            class="option">n</replaceable></option></term>

            <listitem>
              <para>Set MIDI smpte conversion mode. n is an integer,
              corresponding to the -M command line option.</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>

      <section id="sync_remote_commands" xreflabel="xjadeo sync. commands" >
        <title>General xjadeo sync commands</title>

        <variablelist>
          <varlistentry>
            <term><option>seek <replaceable
            class="option">frame</replaceable></option></term>

            <listitem>
              <para>Display the indicated frame (only when disconnected from
              any sync source.)</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>get position</option></term>

            <listitem>
              <para>Returns the current frame number.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>get smpte</option></term>

            <listitem>
              <para>Returns the current head position in SMPTE code.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>get syncsource</option></term>

            <listitem>
              <para>Prints the currently active source: 2:Midi, 1:jack, 0:none / manual seek</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>get fps</option></term>

            <listitem>
              <para>Returns the current window update rate.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>set fps <replaceable
            class="option">value</replaceable></option></term>

            <listitem>
              <para>Set the window update rate.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>get offset</option></term>

            <listitem>
              <para>Returns the current time offset in frames.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>set offset <replaceable
            class="option">value</replaceable></option></term>

            <listitem>
              <para>Set the time offset in frames.</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>

    <section id="rc_window">
      <title>Monitor Window Commands</title>

      <variablelist>
        <varlistentry>
          <term><option>window close</option></term>

          <listitem>
            <para>Closes the video window.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>window open</option></term>

          <listitem>
            <para>Opens the video window using the default videomode. the
            default videomode is autodetect unless overridden by command
            line.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>window mode <replaceable
          class="option">value</replaceable></option></term>

          <listitem>
            <para>Opens the video window using the specified videomode. a
            value of 0 autodetects while a positive integer corresponds to a
            videomode which can be listed with the <command>list
            videomodes</command> command.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>window resize <replaceable
          class="option">value</replaceable></option></term>

          <listitem>
            <para>Resizes the monitor window. Value may either be a 2
            dimensional vector &lt;width&gt;x&lt;height&gt; of absolute
            values, or a single integer specifying the the window size in
            percentage of the movie file geometry.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>window move <replaceable
          class="option">value</replaceable> </option></term>

          <listitem>
            <para>Position the monitor window on the desktop. value is
            expected to be: &lt;width&gt;x&lt;height&gt;</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get windowsize</option></term>

          <listitem>
            <para>Prints the size of the video window in a 2d vector.
            &lt;width&gt;x&lt;height&gt;</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get videomode</option></term>

          <listitem>
            <para>Returns the current video mode.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>list videomodes</option></term>

          <listitem>
            <para>Prints a list of available video modes.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <section id="rc_notify">
      <title>Notify Commands</title>

      <variablelist>
        <varlistentry>
          <term><option>notify loop </option></term>

          <listitem>
            <para>Enables async messages. xjadeo will generate a 300 reply
            each time it polls for a timecode.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>notify frame </option></term>

          <listitem>
            <para>Enables async messages. xjadeo will generate a 300 reply
            each time it displays a frame.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>notify disable </option></term>

          <listitem>
            <para>Stop generating notify messages.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <section id="rc_osd">
      <title>On Screen Display Commands</title>

      <variablelist>
        <varlistentry>
          <term><option>osd frame <replaceable
          class="option">ypos</replaceable></option></term>

          <listitem>
            <para>Render current framenumber on screen. ypos specifies the
            vertical position in percent (0..100). the text is horizontally
            centered. a value &lt;0 disables the frame display.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd smpte <replaceable
          class="option">ypos</replaceable></option></term>

          <listitem>
            <para>Render SMPTE on screen. ypos specifies the vertical position
            in percent. the text is horizontally centered. a ypos value &lt;0
            disables SMPTE OSD.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd text <replaceable
          class="option">text</replaceable></option></term>

          <listitem>
            <para>Renders the specified text on the screen. the position can
            be specified with the <command>osd pos</command> command.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd text </option></term>

          <listitem>
            <para>Display the previously set OSD text again.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd notext </option></term>

          <listitem>
            <para>Turn off OSD text.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd off </option></term>

          <listitem>
            <para>Alias for <command>osd notext</command></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd on </option></term>

          <listitem>
            <para>Synonym for <command>osd text</command></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd pos <replaceable
          class="option">xalign</replaceable> <replaceable
          class="option">ypos</replaceable></option></term>

          <listitem>
            <para>Sets the position of the OSD text</para>

            <para>xalign is an integer: 0:Left, 1:Center, 2:Right</para>

            <para>ypos specifies the vertical position in percent
            (0..100).</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd available </option></term>

          <listitem>
            <para>displays if freetype support in available.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd font <replaceable
          class="option">font-filename</replaceable></option></term>

          <listitem>
            <para>Specifies the TrueType Font file to use when rendering
            text.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd box </option></term>

          <listitem>
            <para>draws a black box around the OSD</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>osd nobox </option></term>

          <listitem>
            <para>make On Screen Display background transparent.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>get osdcfg</option></term>

          <listitem>
            <para>Return information on which text is currently rendered on screen in a bitwise integer encoding:</para>
	    <para> bit0 (1): Frame, &nbsp;&nbsp;&nbsp;  bit1(2): SMPTE timecode, &nbsp;&nbsp;&nbsp; bit2(4): Text </para>
          </listitem>
        </varlistentry>

      </variablelist>
    </section>

    <section id="response_format">
      <title>Response Format</title>

      <para>Each remote command is acknowledged with a response, which you can
      ignore at your wish. It is intended to be both human readable and
      machine parse-able. The response is a single line terminated with the newline character
      '\n' formatted as: <screen>@&lt;status-integer&gt; &lt;text&gt;</screen>
      each line start with an @ followed by an integer that tells if the
      command succeeded and specifies the format of the text. The status
      integer is usually a 3 digit decimal number in [100..999]: <variablelist>
          <varlistentry>
            <term><option>1xx:</option></term>

            <listitem>
              <para>ok. the command succeeded returning a small text info
              message.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>2xx:</option></term>

            <listitem>
              <para>the command succeeded and the return text is in format
              name=value</para>

              <para>This is used for returning variables. 200-299 defines the
              type of the value as follows:</para>

              <variablelist>
                <varlistentry>
                  <term><option>201:</option></term>

                  <listitem>
                    <para>integer</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><option>202:</option></term>

                  <listitem>
                    <para>double</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><option>210:</option></term>

                  <listitem>
                    <para>2d vector &lt;int&gt;x&lt;int&gt;</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><option>220:</option></term>

                  <listitem>
                    <para>string</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><option>228:</option></term>

                  <listitem>
                    <para>smpte-string in format 'HH:MM:SS:FF'</para>
                  </listitem>
                </varlistentry>
              </variablelist>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>3xx:</option></term>

            <listitem>
              <para>these are messages that are generated by xjadeo notify,
              not in response to a command. the format and type declaration is
              identical to 2xx messages. Currently the only 3xx message is 301
              position=integer.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>4xx:</option></term>

            <listitem>
              <para>error message.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>8xx:</option></term>

            <listitem>
              <para>info or help message. These messages are meant to be
              ignored by automatic parsers and are for user information or
              displaying comments only.</para>
            </listitem>
          </varlistentry>
        </variablelist></para>
    </section>
  </section>

  <section id="internals">
    <title>Internals</title>

    <section id="behind_the_scenes">
    <title>Behind the Scenes</title>
	<para>When <application>xjadeo</application> is started, it</para>
	<orderedlist>
	<listitem>
	  <para>Checks that jackd is running and connects as a client.</para>
	</listitem>

        <listitem>
          <para>Opens the video file and window.</para>
        </listitem>

        <listitem>
          <para>Enters a loop that:</para>

	  <orderedlist>
		<listitem>
		  <para>Queries jack time position.</para>
		</listitem>

		<listitem>
		  <para>Calculates and displays the appropriate video frame.</para>
		</listitem>
		<listitem>
		  <para>Handle display events.</para>
		</listitem>
		<listitem>
		  <para>Sleep for the duration of the <option>framerate delay</option> subtracted by the time needed for this loop.</para>
		  <para>If this xjadeo instance is remote controlled, any input will interrupt the sleep and execute the command.</para>
		</listitem>
          </orderedlist>
        </listitem>
      </orderedlist>

      <para>The loop runs 'framerate' times per second, depending on what you
      entered in the command line. This loop is not synchronized to anything. xjadeo uses the select() and gettimeofday() system calls for internal time keeping.</para>
    </section>

    <section id="sync_info">
    <title>Synchronization Accuracy</title>
    <para>xjadeo does not provide an exact time base for online-editing! Always stop the transport when you need to define a sync point!</para>
    <para>There current version of xjadeo decodes the video just in time (as opposed to ahead in time). This introduces a random latency. screen updates are not locked to any time source.</para>
    <para>xjadeo polls the time source at regular intervals. Try increasing the update framerate with <option>-f</option> to multiples of the framerate; or drop us a motivating line to code the VSync extension. So far we are perfectly happy editing soundtracks at 10 video frames per second.</para>
    </section>

    <section id="frame_convert">
    <title>Frame Transformation</title>
    <para>The calculation from jack frame/framerate to video frame/framerate and SMPTE timecode is done using
    double precision arithmetics with seconds as basis unit. The conversion Audio Frame to Video SMPTE is done by 
    calculating audio-frame / audio-frame-rate * video-frame-rate and round down to the nearest integer.
    Integer video-frame offsets (<option>-o &lt;integer&gt;</option>are applied afterwards.
    </para>
    <para>This depends on correctly detecting the framerate of the video file, which can be overridden with <option>-F</option>.</para>
    </section>

    <section id="midi_clock">
    <title>Midi Clock Conversion</title>
    <para>MTC includes information about the framerate of the SMPTE timecode, which is used by xjadeo for generating the framecount independent of the movie clip's framerate. Naturally you want to adjust the midi time source to match the exact framerate of the video that you want to work with. 
    Timecode freaks and desparate engineers can resort to force the converter algorithm to use the video-file's framerate value with the <option>--midifps</option> and <option>--filefps</option> option.</para>
    <para> Starting with version 0.3.22 xjadeo supports drop-frame timecode and non-integer framerates.
    Midi and SMPTE clock parsing is implemented using bitwise integer and long integer arithmetic operations.</para>
    </section>

  </section>

  <appendix id="manual_pages">
    <title>Manual Pages</title>

    <refentry id="xjadeo">
    <refmeta>
    <refentrytitle>xjadeo</refentrytitle>
    <manvolnum>1</manvolnum>
    </refmeta>

    <refnamediv>
        <refname>xjadeo</refname>

        <refpurpose>displays a video clip in sync with an external timing
        source</refpurpose>
      </refnamediv>

      <refsynopsisdiv>
        <cmdsynopsis>
          <command>xjadeo</command>
          <arg choice="opt">-abfFhiIkKLmMoPqQRStvVx</arg>
          <arg choice="plain"><replaceable>videofile</replaceable></arg>
<!--
	options: -a , -b, -f <num>, -F <int>,...
-->
        </cmdsynopsis>
        <cmdsynopsis>
          <command>xjadeo</command>
          <arg choice="plain">-R</arg>
          <arg choice="opt">-Q</arg>
          <arg choice="opt">-abfFhikKLmMoqtvVx</arg>
          <arg choice="opt"><replaceable>videofile</replaceable></arg>
        </cmdsynopsis>
        <cmdsynopsis>
          <command>xjadeo</command>
          <arg choice="plain">-Q</arg>
          <arg choice="opt">-R</arg>
          <arg choice="opt">-abfFhikKLmMoqtvVx</arg>
          <arg choice="opt"><replaceable>videofile</replaceable></arg>
        </cmdsynopsis>
      </refsynopsisdiv>

      <refsect1>
        <title>DESCRIPTION</title>

        <para><command>xjadeo</command> displays a video clip in sync with an
        external timing source. It is a handy tool to help with the
        synchronization of the soundtrack of a video file.
        <command>xjadeo</command> supports different video file formats, video
        output libraries and sync sources.</para>
      </refsect1>


      <refsect1>
        <title>OPTIONS</title>
        <variablelist>

          <varlistentry>
            <term><option>-a, --ontop</option></term>
            <listitem>
              <para>Start xjadeo on top of other windows. (affects XV videomode only).</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-b, --letterbox</option></term>

            <listitem>
              <para>retain aspect ratio and draw a letterbox around the move if necessary.
	      Note that this feature is only available with the Xv and imlib2 video mode.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-C, --midiclk</option></term>

            <listitem>
              <para>use midi quarter frame timing for more exact sync.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-f <replaceable class="option">n</replaceable></option>,
	    <option>--fps <replaceable class="option">n</replaceable></option></term>

            <listitem>
              <para>Desired refresh rate of the video display in frames per
              second. Lower values lighten the CPU load at the cost of video
              quality. Admits non-integer values. Defaults to 10.0 fps.</para>
	      <para> If this value is set to zero (or less), xjadeo will use the framerate of the 
	      video file as its video update frequency.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-F <replaceable class="option">n</replaceable></option>, 
	    <option>--filefps <replaceable class="option">n</replaceable></option></term>

            <listitem>
              <para>Override the (autodetected) framerate of the videofile.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-h, --help</option></term>

            <listitem>
              <para>Prints usage help and exits.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-i <replaceable class="option">n</replaceable></option>,
	    <option>--info <replaceable class="option">n</replaceable></option></term>

            <listitem>
              <para>Displays useful info using the OSD (on-screen
              display.)<variablelist>
                  <varlistentry>
                    <term><option>0</option></term>

                    <listitem>
                      <para>Off.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term><option>1</option></term>

                    <listitem>
                      <para>Frame number.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term><option>2</option></term>

                    <listitem>
                      <para>SMPTE time code.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term><option>3</option></term>

                    <listitem>
                      <para>Both frame number and SMPTE.</para>
                    </listitem>
                  </varlistentry>
                </variablelist>The remote interface allows more complete
              control over the OSD.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-I, --ignorefileoffset</option></term>
            <listitem>
              <para>This option is only useful for video files that with a start-offset, such
	      as splitted avi or vob files. Per default xjadeo will honor offsets specified in the 
	      video-file header and the file's pts/dts. <option>-I</option> allows to override and 
	      subtract this offset and makes the file start at SMPTE position 00:00:00:00.
	      (although you can archive the same result, this option is not related to <option>-o</option>
	      which actually changes the SMPTE.)</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-k, --keyframes </option></term>

            <listitem>
              <para>Instructs the internal algorithm to seek only keyframes.
              This option may improve the performance for certain video encodings. </para>
	      <para>The default behavior (without -k and -K arguments) is to search any ANY frame.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-K, --continuous </option></term>

            <listitem>
              <para>Decode video frame by frame, particularly only useful to read files where not every frame is a keyframe at cost of CPU usage. Note that this option adds some extra latency when seeking. combine with <option>-f </option>: It makes sense to set xjadeo's framerate to equal the framerate of the video file.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-L, --nolash</option></term>

            <listitem>
              <para>Disable LASH support.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-m <replaceable class="option">port</replaceable></option>,
	    <option>--midi <replaceable class="option">port</replaceable></option></term>

            <listitem>
              <para>Get sync from MTC (MIDI Time Code) instead of jack.</para>

              <para>If compiled with ALSA midi, <replaceable
              class="option">port</replaceable> is the ALSA sequencer id of
              the MTC source. A value of -1 will leave
              <command>xjadeo</command> unconnected.</para>

              <para>If using portmidi, <replaceable
              class="option">port</replaceable> is the portnumber of the midi
              input to use. value -1 will attempt autoconnect. use -v -m -1 to
              list midi ports during autodetection.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-M<replaceable class="option">n</replaceable></option>,
	    <option>--midifps <replaceable class="option">n</replaceable></option></term>

            <listitem>
              <para>Conversion between MTC SMPTE and frame number.
              <variablelist>
                  <varlistentry>
                    <term><option>0</option></term>

                    <listitem>
                      <para>Use MTC clock frame rate.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term><option>2</option></term>

                    <listitem>
                      <para>Use video file frame rate.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term><option>3</option></term>

                    <listitem>
                      <para>Resample video frame rate / MTC.</para>
                    </listitem>
                  </varlistentry>
                </variablelist></para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-o <replaceable class="option">n</replaceable></option>,
	    <option>--offset <replaceable class="option">n</replaceable></option></term>

            <listitem>
              <para>Offset the video player a certain number of (video) frames
              relative to the sync master time base. Admits negative
              values.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-P, --genpts</option></term>

            <listitem>
              <para>This option passed on to ffmpeg and has no effect on older versions of libavformat.</para>
	      <para>it can be used to generate "presentation time stamps" if they are missing in the file,
	      even if it requires parsing future frames.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-q, --quiet, --silent</option></term>

            <listitem>
              <para>Suppresses normal output messages.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-Q, --mq</option></term>

            <listitem>
              <para>Enable POSIX message queues. Sets up a communication channel for use with 
	      <xref linkend="xjremote"/>.  See the <xref linkend="remote_control_interface"/> in the documentation.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-R, --remote</option></term>

            <listitem>
              <para>Enables interactive (stdin/stdout) control mode. Options
              <option>--quiet</option> and <option>--verbose</option> have no
              effect in remote mode.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-S, --nosplash</option></term>

            <listitem>
              <para>Skip the on screen display startup sequence.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-t, --try-codec</option></term>

            <listitem>
              <para>Checks if the video file is encoded in a format suitable
              for use with <command>xjadeo</command> and exits. If the video
              format is not supported the exit code is 1.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-v, --verbose</option></term>

            <listitem>
              <para>Prints additional information during the execution.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-V, --version</option></term>

            <listitem>
              <para>Display version and compile-time configuration information and exit.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-x <replaceable class="option">n</replaceable></option>,
	    <option>--vo <replaceable class="option">n</replaceable></option>,
	    <option>--videomode <replaceable class="option">n</replaceable></option></term>

            <listitem>
              <para>Selects the video output driver. Defaults to 0
              (autodetect.) A value of -1 makes the program list the available
              drivers and exit.</para>
            </listitem>
          </varlistentry>

        </variablelist>
      </refsect1>

      <refsect1>
        <title>SYNC SOURCES</title>

        <para><command>xjadeo</command> currently supports the following
        synchronization sources:</para>

        <itemizedlist>
          <listitem>
            <para>Jack transport.</para>
          </listitem>

          <listitem>
            <para>MTC (MIDI Time Code) via ALSA sequencer.</para>
          </listitem>

          <listitem>
            <para>MTC (MIDI Time Code) via portmidi.</para>
          </listitem>
        </itemizedlist>
      </refsect1>

      <refsect1>
        <title>VIDEO DRIVERS</title>

        <para><command>xjadeo</command> currently supports the following video
        output drivers:</para>

        <itemizedlist>
          <listitem>
            <para>xv (YUV / YV12)</para>
          </listitem>

          <listitem>
            <para>SDL (YUV / YV12)</para>
          </listitem>

          <listitem>
            <para>ImLib (RGB / RGBA)</para>
          </listitem>

        </itemizedlist>
      </refsect1>

      <refsect1>
        <title>VIDEO FORMATS</title>

        <para><command>xjadeo</command> uses the ffmpeg libraries to decode
        video files, so a wide range of codecs is available. Note, however,
        that not all the formats support frame seeking. You can use a command
        like:</para>

        <screen>mencoder -idx -ovc lavc -lavcopts keyint=1 -nosound input_file.xxx -o output_file.avi</screen>

        <para>This creates from your input-file.xxx an AVI mpeg4 encoded video
        file with no sound, an index (-idx) and no compression between frames
        (every frame is a keyframe). The file thus can become really BIG, so
        watch out your disk space.</para>

        <para>You may also want to shrink the size of the frame by adding the
        option</para>

        <screen>-vf scale=width:height</screen>

        <para>This will reduce the size of the avi file, will tax less the
        system resources when displayed and will leave more space in the
        screen for your audio software.</para>
      </refsect1>

      <refsect1>
        <title>USER INPUT</title>

        <para><command>xjadeo</command> window accepts the following
        input:</para>

        <itemizedlist>
          <listitem>
            <para>Resizing the window will resize the movie as well. (CAVEAT:
            resizing a video frame to make it fit the window is a CPU
            expensive operation unless you are using hardware overlay. If you
            are not comfortable with the frame size of your movie it is more
            CPU efficient that you re-encode the video file with the desired
            size beforehand.)</para>
          </listitem>

          <listitem>
            <para>Pressing mouse button 1 will resize the window to the
            original movie size.</para>
          </listitem>

          <listitem>
            <para>Mouse button 2 and 3 resize the window to match the movie
            aspect ratio.</para>
          </listitem>

          <listitem>
            <para>Scroll Wheel (buttons 4,5) stepwise decreases/increases the
            window size maintaining the original aspect ratio.</para>
          </listitem>

          <listitem>
            <para>Closing the window or pressing ctrl-C will terminate
            <command>xjadeo</command>.</para>
          </listitem>
          <listitem>
	    <para> xjadeo >= v0.3.8 supports keyboard events. Pressing 'Esc' and 'q' will end the program.
	    depending on your display setup xjadeo supports 'f' toggle fullscreen, 'a' toggle always-on-top and 'm' to hide mouse cursor keystrokes.</para>
          </listitem>
        </itemizedlist>
      </refsect1>

      <refsect1>
        <title>REMOTE MODE</title>
	<para><command>xjadeo -Q</command> enables message queues; use <command>xjremote</command> to connect.</para>

        <para>When started in remote mode (option <option>-R</option> or
        <option>--remote</option>) <command>xjadeo</command> will
        interactively accept commands and issue responses through its standard
        input/output mechanism.</para>

        <para>Use the remote command <command>help</command> to get a quick
        overview of all available commands. please refer to the docbook
        documentation for a complete description of the remote
        commands.</para>
      </refsect1>

      <refsect1>
        <title>FILES</title>
	<para>xjadeo reads the following resource config files in this order:</para>
          <orderedlist>
		<listitem>
			<para>/@SYSCONFDIR@/xjadeorc (usually /etc/xjadeorc
			or /usr/local/etc/xjadeorc, which depends on your
			distribution and on the configuration when
			<xref linkend="build"/>)</para>
		</listitem>
		<listitem>
			<para>$HOME/.xjadeorc</para>
		</listitem>
		<listitem>
			<para>$HOME/xjadeorc</para>
		</listitem>
          </orderedlist>
	  <para>Each line in the config file must be in in the format:<screen>KEY=VALUE</screen>. If the first character on a line is either '#' or ';'. the line is ignored. <option>KEYS</option> are not case sensitive. <option>VALUES</option> can be case sensitive (fi. filenames) and are parsed identical to the corresponding command line arguments (eg. <option>-x SDL</option> becomes <option>videomode=SDL</option>). Boolean values are specified as 'yes' or 'no' (eg. <option>quiet=yes</option>).</para>
	  <para>currently supported rc KEYS: fps, fontfile, lash, letterbox, midiclk, midismpte, mq, nosplash, quiet, seek, verbose and videomode. Which are commented on in the example <ulink 
          url="http://svn.sourceforge.net/viewcvs.cgi/*checkout*/xjadeo/trunk/doc/xjadeorc" >xjadeorc</ulink>
	  </para>
      </refsect1>

      <refsect1>
        <title>SEE ALSO</title>
    	<para><xref linkend="qjadeo"/></para>
    	<para><xref linkend="xjremote"/></para>
    	<para><xref linkend="xjinfo"/></para>
      </refsect1>

    </refentry>


    <refentry id="qjadeo">
      <refmeta>
        <refentrytitle>qjadeo</refentrytitle>
    	<manvolnum>1</manvolnum>
      </refmeta>

      <refnamediv>
        <refname>qjadeo</refname>

        <refpurpose>GUI front-end to <command>xjadeo</command></refpurpose>
      </refnamediv>

      <refsynopsisdiv>
        <cmdsynopsis>
          <command>qjadeo</command>

        </cmdsynopsis>
      </refsynopsisdiv>

      <refsect1>
        <title>DESCRIPTION</title>

        <para><command>xjadeo</command> displays a video clip in sync with an
        external timing source. It is a handy tool to help with the
        synchronization of the soundtrack of a video file.
        <command>qjadeo</command> is a graphical frontend to xjadeo. It communicates
	with xjadeo either directly (single session) or using xjremote.</para>
      </refsect1>

      <refsect1>
        <title>ENVIRONMENT</title>

        <para>If the XJREMOTE variable is set, qjadeo
        will assume that it holds the path to the xjadeo/xjremote executable.</para>
      </refsect1>

      <refsect1>
        <title>SEE ALSO</title>
    	<para><xref linkend="xjadeo"/></para>
    	<para><xref linkend="xjremote"/></para>
      </refsect1>
    </refentry>
 
    <refentry id="xjremote">
      <refmeta>
        <refentrytitle>xjremote</refentrytitle>
    	<manvolnum>1</manvolnum>
      </refmeta>

      <refnamediv>
        <refname>xjremote</refname>

        <refpurpose>CLI front-end to <command>xjadeo</command></refpurpose>
      </refnamediv>

      <refsynopsisdiv>
        <cmdsynopsis>
          <command>xjremote</command>
          <arg choice="opt">-fhquUvV</arg>
        </cmdsynopsis>
      </refsynopsisdiv>

      <refsect1 id="xjremote_description">
        <title>DESCRIPTION</title>

        <para><command>xjadeo</command> displays a video clip in sync with an
        external timing source. It is a handy tool to help with the
        synchronization of the soundtrack of a video file.</para>

        <para><command>xjremote</command>  connects to a 
	instance of xjadeo and allows a user to tweak the running configuration.</para>

	<para>If it can not connect, xjremote will start a new instance of xjadeo
	and open a connection to it. see <option>-f</option></para>
      </refsect1>

      <refsect1>
        <title>OPTIONS</title>

        <variablelist>
          <varlistentry>
            <term><option>-f, --nofork</option></term>

            <listitem>
              <para>disable automatic startup of xjadeo. Instead xjremote will terminate
	      if it can not connect to a running xjadeo.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-h, --help</option></term>

            <listitem>
              <para>Prints usage help and exits.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-P, --noping</option></term>

            <listitem>
              <para>Skip checking for xjadeo live signs (ping).</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-q, --quiet, --silent</option></term>

            <listitem>
              <para>Suppresses normal output messages.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-R</option></term>

            <listitem>
              <para>ignored (no action) - <command>xjremote</command> can be used as a drop in replacement for <command>xjadeo -R</command>.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-u, --unlink</option></term>

            <listitem>
              <para>remove existing queues. unless combined with <option>-f</option>. This will launch a new xjadeo instance.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-U, --unlinkonly</option></term>
            <listitem>
              <para>remove existing queues and exit. This is equivalent (but not identical) to <option>-u -f</option>.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-v, --verbose</option></term>

            <listitem>
              <para>Prints additional information during the execution.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><option>-V, --version</option></term>

            <listitem>
              <para>Prints version information end exits.</para>
            </listitem>
          </varlistentry>
        </variablelist>
         
      </refsect1>

      <refsect1>
        <title>ENVIRONMENT</title>

        <para>If the XJADEO variable is set, xjremote
        will assume that it holds the path to the xjadeo executable.</para>
      </refsect1>

      <refsect1>
        <title>SEE ALSO</title>
    	<para><xref linkend="xjadeo"/></para>
    	<para><xref linkend="qjadeo"/></para>
      </refsect1>

    </refentry>


    <refentry id="xjinfo">
      <refmeta>
        <refentrytitle>xjinfo</refentrytitle>
    	<manvolnum>1</manvolnum>

      </refmeta>

      <refnamediv>
        <refname>xjinfo</refname>

        <refpurpose>Display A/V file info in XML format.</refpurpose>
      </refnamediv>

      <refsynopsisdiv>
        <cmdsynopsis>
          <command>xjinfo</command>
          <arg choice="opt">-xvhct</arg>
          <arg choice="plain"><replaceable>videofile</replaceable></arg>
        </cmdsynopsis>
      </refsynopsisdiv>

      <refsect1>
        <title>DESCRIPTION</title>

        <para><command>xjinfo</command> does basically the same as
	<command>ffmpeg -i</command> but displays the information in
	XML or simple format that can be used for scripting.</para>

      </refsect1>

      <refsect1>
        <title>OPTIONS</title>

        <variablelist>
          <varlistentry>
            <term><option>-c, --csv</option></term>
            <listitem>
              <para>comma separated values, one line per video stream in file.
	      Use the built-in help -h to learn about the format.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><option>-h, --help</option></term>
            <listitem>
              <para>Prints usage help and exits.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><option>-t, --time, --duration</option></term>
            <listitem>
              <para>output XML data. This is the default if no option is specified</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><option>-v, --text</option></term>
            <listitem>
              <para>print a single line: duration, fps, geometry and codec info.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><option>-x, --xml</option></term>
            <listitem>
              <para>output XML data. This is the default if no option is specified.</para>
	      <para>A DTD is available with the source or from
	      <ulink url="http://svn.sourceforge.net/viewcvs.cgi/*checkout*/xjadeo/trunk/src/xjadeo/avinfo.dtd">xjadeo.sf.net</ulink>
	      </para>
            </listitem>
          </varlistentry>
        </variablelist>
      </refsect1>

      <refsect1>
        <title>SEE ALSO</title>
    	<para><xref linkend="xjadeo"/></para>
      </refsect1>
    </refentry>
  </appendix>
</article>
